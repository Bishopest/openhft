@page "/"
@using OpenHFT.GUI.Components.Shared
@using OpenHFT.GUI.Services
@using OpenHFT.Core.Instruments
@using OpenHFT.Core.Models

@inherits ComponentBase

@namespace OpenHFT.GUI.Components.Pages

<PageTitle>Home</PageTitle>

@*
    CHANGE 1: This MudContainer becomes a full-height, column-oriented flex container.
    - 'd-flex flex-column': Turns it into a flex container.
    - 'flex-grow-1': This is the KEY. It makes the container expand to fill all
      available vertical space within the MainLayout.
*@
<MudPaper Class="pa-4" Elevation="2">
    @* --- OMS Connection Component --- *@
    @* We pass down the server list and current status, and listen for connect/disconnect events *@
    <OmsConnectionManager Servers="_omsServers" CurrentStatus="_currentStatus" OnConnect="HandleConnectRequest"
        OnDisconnect="HandleDisconnectRequest" />

    @if (_displayInstrument is not null)
    {
        @*
            CHANGE 2: This MudGrid also becomes a growing flex item.
            It will now fill all the space NOT taken by the h1 and MudText above it.
            'AlignItems.Stretch' ensures the MudItems inside it also stretch vertically.
        *@
        <MudGrid Spacing="0">
            <MudItem xs="12" md="6">
                <OrderBookDisplay DisplayInstrument="@_displayInstrument" />
            </MudItem>
            <MudItem xs="12" md="6">
                <QuotingParametersController @ref="_quotingController" OnSubmit="HandleSubmitParameters"
                    OnCancel="HandleCancelParameters" OnInstrumentSelected="HandleInstrumentSelected"
                    IsStrategyActive="@(_displayInstrument != null && _activeInstances.ContainsKey(_displayInstrument.InstrumentId))" />
            </MudItem>
        </MudGrid>
    }
</MudPaper>