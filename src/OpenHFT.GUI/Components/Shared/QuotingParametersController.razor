@namespace OpenHFT.GUI.Components.Shared
@using OpenHFT.Core.Models
@using OpenHFT.Core.Instruments
<MudPaper Class="pa-4" Style="height: 100%;">
    <MudText Typo="Typo.h6" GutterBottom="true">Deploy New Strategy</MudText>
    <MudForm @ref="_form">
        <MudStack Spacing="3">
            <MudAutocomplete T="Instrument" Label="Instrument" @bind-Value="_selectedInstrument"
                SearchFunc="@SearchInstruments" ToStringFunc="@ConvertInstrumentToString" Variant="Variant.Outlined"
                Required="true" ResetValueOnEmptyText="true" CoerceText="true" CoerceValue="true">
                <ItemTemplate Context="instrument">@instrument.Symbol (@instrument.SourceExchange)
                    (@instrument.ProductType)</ItemTemplate>
            </MudAutocomplete>
            <MudNumericField @bind-Value="_model.SpreadBp" Label="Spread (bp)" Variant="Variant.Outlined"
                Required="true" Min="0" />
            <MudNumericField @bind-Value="_model.SkewBp" Label="Skew (bp)" Variant="Variant.Outlined" Required="true" />
            <MudNumericField @bind-Value="_model.Size" Label="Size (Quantity)" Variant="Variant.Outlined"
                Required="true" Min="0" Step="0.001m" />
            <MudNumericField @bind-Value="_model.Depth" Label="Depth (Levels)" Variant="Variant.Outlined"
                Required="true" Min="1" />
            <MudAutocomplete T="Instrument" Label="FV Source Instrument" @bind-Value="_selectedFvSourceInstrument"
                SearchFunc="@SearchInstruments" ToStringFunc="@ConvertInstrumentToString" Variant="Variant.Outlined"
                Clearable="true" ResetValueOnEmptyText="true" CoerceText="false" CoerceValue="false">
                <ItemTemplate Context="instrument">
                    @instrument.Symbol (@instrument.SourceExchange) (@instrument.ProductType)
                </ItemTemplate>
                <NoItemsTemplate>
                    <MudText Class="pa-4">No matching instruments found.</MudText>
                </NoItemsTemplate>
            </MudAutocomplete>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="HandleSubmit" Class="mt-4">Submit
            </MudButton>
            <MudButton Variant="Variant.Outlined" Color="Color.Secondary" OnClick="HandleCancel">Cancel</MudButton>
        </MudStack>
    </MudForm>
</MudPaper>