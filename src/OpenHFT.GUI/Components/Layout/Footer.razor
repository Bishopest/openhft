@namespace OpenHFT.GUI.Components.Layout
@using OpenHFT.GUI.Services

@* Use MudPaper as the root for more height flexibility *@
<MudPaper Elevation="4" Square="true" Class="d-flex align-center pa-2 gap-4" Style="flex-shrink: 0;">
    @foreach (var server in _omsServers)
    {
        <MudPaper Outlined="true" Class="pa-2" Style="min-width: 250px;">
            <MudGrid Spacing="1" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Center">

                @* Left Column: Server Name and Status *@
                <MudItem xs="7">
                    <MudText Typo="Typo.body1" Style="font-weight: bold;">@server.Name</MudText>
                    <MudText Typo="Typo.body1" Color="@GetStatusColor(server)" Variant="Variant.Outlined">
                        @(_connectedServer == server ? _currentStatus.ToString() : "Disconnected")
                    </MudText>
                </MudItem>

                @* Right Column: Action Buttons *@
                <MudItem xs="5" Class="d-flex flex-column gap-1">
                    <MudButton Size="Size.Small" Variant="Variant.Filled" Color="Color.Primary"
                        OnClick="() => HandleConnectClick(server)"
                        Disabled="@(_currentStatus != ConnectionStatus.Disconnected && _connectedServer != server)">
                        @if (_currentStatus == ConnectionStatus.Connecting && _connectedServer == server)
                        {
                            <MudProgressCircular Size="Size.Small" Indeterminate="true" />
                        }
                        else
                        {

                            <text>Connect</text>
                        }
                    </MudButton>
                    <MudButton Size="Size.Small" Variant="Variant.Outlined" OnClick="HandleDisconnectClick"
                        Disabled="@(_connectedServer != server)">
                        Disconnect
                    </MudButton>
                </MudItem>

            </MudGrid>
        </MudPaper>
    }
    <MudSpacer />
</MudPaper>